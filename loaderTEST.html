<!DOCTYPE html>

<html>

<head>

    <meta charset="utf-8">

    <!-- fix device height, fix scale, hide browser default bars -->

    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, minimal-ui">

    <!-- STYLE -->

    <link rel="stylesheet" href="style/css/reset.css">
    <style media="screen">
        #renderCanvas {
            width: 100%;
            height: 100%;
        }
    </style>
    <!-- libraries -->

    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="lib/schteppe-cannon.js/build/cannon.js"></script>

    <!-- scripts -->
    <script src="lib/Babylon.js/dist/loaders/babylon.objFileLoader.min.js"></script>

    <title>Digital Media 3D Art Gallery</title>

</head>

<body>


    <canvas id="renderCanvas"></canvas>

    <!-- babylon contents script from here -->
    <script>
        var canvas = document.getElementById("renderCanvas");
        var engine = new BABYLON.Engine(canvas, true);

        var createScene = function() {
            var scene = new BABYLON.Scene(engine);
            var assetsManager = new BABYLON.AssetsManager(scene);
            var meshTask = assetsManager.addMeshTask("Interior", "", "assets/", "untitled.babylon");
            


            //Adding an Arc Rotate Camera
var camera = new BABYLON.WebVRFreeCamera("camera1", new BABYLON.Vector3(-15, 50, -5), scene);
            // var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(-15, 50, -5), scene);
            camera.setTarget(BABYLON.Vector3.Zero());
            camera.checkCollisions = true;
            camera.ellipsoid = new BABYLON.Vector3(5, 10, 5);
            camera.minZ = 0.8;
            camera.speed = 3;
            camera.keysUp.push('W'.charCodeAt(0));
            camera.keysDown.push('S'.charCodeAt(0));
            camera.keysLeft.push('A'.charCodeAt(0));
            camera.keysRight.push('D'.charCodeAt(0));
            camera.attachControl(canvas, true);
            camera.applyGravity = false;
            scene.gravity = new BABYLON.Vector3(0, -1, 0);

            //Adding a light
            var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(1, 10, 1), scene);
            light.intensity = 0.6;

            meshTask.onSuccess = function(task) {
                task.loadedMeshes[0].position = new BABYLON.Vector3(0, 0, 0);
                engine.loadingUIText = "Loaded asset " + task.loadedMeshes[0].name;
                console.log(task.loadedMeshes[0].name);
            }
                assetsManager.onTaskError = function(task) {
                console.log("error on Loading" + task.name);
            }
                assetsManager.onProgress = function(remainingCount, totalCount, lastFinishedTask) {
                engine.loadingUIText = 'We are loading the scene. ' + remainingCount + ' out of ' + totalCount + ' items still need to be loaded.';
            };

            // Move the light with the camera
            scene.registerBeforeRender(function() {
                light.position = camera.position;
            });

            assetsManager.onFinish = function(tasks) {
                engine.runRenderLoop(function() {
                    scene.render();
                });
            };

            assetsManager.load();

            return scene;
        }
        var scene = createScene();

        //        engine.runRenderLoop(function() {
        //            scene.render();
        //        });

        // Resize
        window.addEventListener("resize", function() {
            engine.resize();
        });
    </script>
    <!-- <script type="text/javascript" src="js/threeJsFront.js"></script> -->
    <!-- <script type="text/javascript" src="js/load_main.js"></script> -->
</body>

</html>